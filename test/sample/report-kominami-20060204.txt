jsp_flat(TOPPERS/JSPのsample1について
                                                            小南 2006/02/04

*  目的
**  006/1/31のミーティングでの確認事項に基いて記述を変更し、TECSの現在の仕様の有効性の確認、問題点の把握、必要な検討事項の洗いだしを行う
**  CDLの文法の確認
**  generatorのテストデータとしても活用する
**  generatorのテストも兼ねる
**  generatorへの要望、提案を提出する

*  方針
**  名前空間を使わない
定義する項目が増えたため、型に対する名前空間指定の繁雑さを避けるため，今回は名前空間を用いず、すべてトップレベルに記述した．。

**  ネーミングコンベンションに則った名前に変更
2006/1/31のミーティングで確認されたネーミングコンベンションに合わせて、セル名などを変更した。

**  Cプリプロセッサによる条件指定による汎用性のある記述
2006/1/31のミーティングで、条件指定などはCプリプロセッサを用いて行うことを確認したことを受けて，名前空間ではなく、#ifdefなど指定するように変更した．

ターゲット依存部、開発環境毎に、intのサイズ、符号の有無、ポインタのサイズ、enumのサイズ，size_tなどを定義し，これらに基づいて、その後の定義を行う
ターゲット依存部や開発環境などに依存せずに、常に固定のサイズの型についてのみ、基本型を用いるようにした。

**  factoryの記述
factory自体は、現在はセルの生成に用いるぐらいしか決まっていない．
記述方法なども決まっていない。

今回は「make_セルタイプ名」という関数を設け、対応する静的APIに指定する項目を引数として渡す記述を行った．


**  上記以外の変更点
***  kominami-20060131.lzh同梱のファイルに対して，sample1のsample1.c, sample1.hで使用されるカーネルオブジェクトの属性を、カーネルオブジェクトセルの属性として設定した。
***  generatorに対する変更
変更点はソースファイル中で

# added by kominami

または

# modified by kominami

で示しています．

****  enum定義にの最後に「;」を記述できるようにした
typedefと同じ位置にenum定義を記述できるようにしたが、このenum定義では最後に「;」をつけるとsyntax errorになった。
今回、他の定義の記述と統一させるために、以下のように';'を追加することでエラーとしないようにした

statement
        # added by kominami  . (2006/2/1) add ';'
        | enum_specifier ';'

****  --strict-name オプションの追加
20060131のミーティングで決めたネーミングコンベンション（推奨）に沿っていないばあいは警告をだす。（厳密では無く、とりあえずの実装)

エラーメッセージのみを表示する-s (--silent)オプションを追加

****  -s (--silent) オプションの追加
エラーメッセージのみを表示する-s (--silent)オプションを追加
デバッグ用文字列出力、エラーメッセージ用文字列出力メソッドをPrtモジュール（新設 prt.rb)に定義し，*.rb内のクラスObjectのメソッドp, puts , printを置き換えた．

Prtのデバッグ用文字列出力メソッドでは、クラスGlobalOptinの（クラス)変数を参照し，silentが指定されている場合は、出力しない
エラーメッセージ用文字列出力メソッドは、そのまま出力する。

****  class GlobalOptionの新設(globaloption.rb)
generatorにコマンドラインで指定したオプションを他のクラス、インスタンスから参照する目的で作成。
コマンドラインオプションの指定から、デバッグメッセージ出力の必要性、警告メッセージ出力の必要性を判定するメソッドも持つ．
この判定機能を変更することで、メッセージ出力を柔軟に切り替えることができる．

現在は，--strict-nameオプションと -s(--silent)オプションと -g(--graph)の情報のみを持つ

# オプション-gの機能は未実装。

****  generatorへのオプション処理機能追加
オプション--strict-nameオプション-s(--silent)とオプション-g(--graph)の判別と，GlobalOptionへ設定する機能を追加

*  課題
**  sample1.cのタスクの関数内で使用されるカーネルオブジェクトを抽出し，セル化する。
**  カーネル外のログタスク，タイマハンドラ，シリアルインタフェースなどをセル化する

*  ファイル一覧

**  data-flat/Makefile
sample1用Makefile
以下の形式で，コマンドラインオプションを指定できる

　make "OPT=コマンドラインオプション" ターゲット


**  data-flat/*.rb
ジェネレータのスクリプト。
上記に述べた機能を追加した。

**  data-flat/jsp_def.h     
SH3/MS7727CP01依存部、GNU開発環境用定義

**  data-flat/jsp_flat.sig          
JSPカーネルが提供するサービスコールと、カーネル上のライブラリ関数のsignature、typedef定義、enum定義
jsp_def.hをインクルードする

**  data-flat/sample1_flat.ct       
JSPカーネルがサポートするカーネルオブジェクトに対応するセルのセルタイプと、タスクMain関数、ハンドラの関数、ルーチンの関数に対応するセルのセルタイプ定義

**  data-flat/sample1_flat.blt　　
sample1用の主にカーネルオブジェクトのセルの定義

**  data-flat/jsp_flat.gif
セルの結合関係を表した図（図の描き方はTECSに則ったものではなく，概略を示しただけである）
縦方向の図。

**  data-flat/jsp_flat2gif
セルの結合関係を表した図（図の描き方はTECSに則ったものではなく，概略を示しただけである）
横方向の図。

**  data-flat/*.CPP
対応する*.sig, *.ct, *.bltをCPP前処理したファイル

**  data-normal/*.idl
generatorの正常系用テストデータ

**  data-error/*.idl
generatorの異常系用テストデータ（エラーを報告するもの）

**  data-abormal/*.idl
generatorの異常系用テストデータ（generatorが例外を発生して止まるもの)

**  naming-convention.txt
2006/01/31のミーティングで決めたセルタイプ名、セル名などの命名慣習（推奨）

**  report-kominami-20060204.txt
本ファイル

**  TECS-kominami-20060204.txt
TECSの仕様、CDLの文法、generatorなどに関するコメンと，バグレポートなど


